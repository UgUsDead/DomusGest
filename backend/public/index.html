<!doctype html><html lang="pt"><head><meta charset="utf-8"/><link rel="icon" type="image/x-icon" href="favicon.ico"/><meta name="viewport" content="width=device-width,initial-scale=1"/><meta name="theme-color" content="#000000"/><meta name="description" content="Web site created using create-react-app"/><link rel="icon" href="/logo192.png"/><link rel="manifest" href="/manifest.json"/><title>DomusGest</title>
	<!-- Force password change overlay shim -->
	<script>
		(function(){
			var MUST_KEY = 'domusgest_force_pwd_change';

			function h(tag, attrs, children){
				var el = document.createElement(tag);
				if (attrs) Object.keys(attrs).forEach(function(k){
					if (k === 'style' && typeof attrs[k] === 'object'){
						Object.assign(el.style, attrs[k]);
					} else if (k === 'text') {
						el.textContent = attrs[k];
					} else {
						el.setAttribute(k, attrs[k]);
					}
				});
				(children||[]).forEach(function(c){ el.appendChild(c); });
				return el;
			}

			function showOverlay(userNif){
				try { sessionStorage.setItem(MUST_KEY, String(userNif||'')); } catch(e){}
				if (document.getElementById('force-change-overlay')) return;
				var backdrop = h('div', { id: 'force-change-overlay', style: {
					position:'fixed', inset:'0', background:'rgba(0,0,0,0.6)', zIndex:'2147483647', display:'flex', alignItems:'center', justifyContent:'center'
				}});
				var card = h('div', { style:{ background:'#fff', borderRadius:'10px', width:'min(92vw, 420px)', boxShadow:'0 10px 30px rgba(0,0,0,0.3)', fontFamily:'system-ui, -apple-system, Segoe UI, Roboto, Arial', color:'#111' } });
				var header = h('div', { style:{ padding:'16px 20px', borderBottom:'1px solid #eee', fontWeight:'600', fontSize:'18px' }, text:'Alteração de palavra‑passe obrigatória' });
				var body = h('div', { style:{ padding:'16px 20px', lineHeight:'1.4' } });
				var info = h('p', { style:{ margin:'0 0 12px 0', fontSize:'14px', color:'#333' } });
				info.innerHTML = 'Por motivos de segurança, tem de definir uma nova palavra‑passe antes de continuar. A palavra‑passe atual é, temporariamente, o seu NIF.';

				var form = h('form', { novalidate:'true' });

				var nifRow = h('div', { style:{ margin:'10px 0 0 0', fontSize:'12px', color:'#555' } });
				nifRow.textContent = 'NIF: ' + (userNif || '(desconhecido)');

				function field(label, type, id){
					var wrap = h('div', { style:{ margin:'10px 0' } });
					var lab = h('label', { for:id, style:{ display:'block', fontSize:'13px', marginBottom:'6px', color:'#222', fontWeight:'600' }, text:label });
					var inp = h('input', { id:id, type:type, required:'true', style:{ width:'100%', padding:'10px 12px', border:'1px solid #ccc', borderRadius:'8px', fontSize:'14px' } });
					wrap.appendChild(lab); wrap.appendChild(inp); return {wrap:wrap, input:inp};
				}

				var cur = field('Palavra‑passe atual (NIF)', 'password', 'dg_cur');
				var npw = field('Nova palavra‑passe', 'password', 'dg_new');
				var cnp = field('Confirmar nova palavra‑passe', 'password', 'dg_conf');

				var err = h('div', { id:'dg_err', style:{ color:'#b00020', fontSize:'13px', minHeight:'18px', marginTop:'6px' } });

				var actions = h('div', { style:{ display:'flex', gap:'10px', marginTop:'8px', alignItems:'center' } });
				var btn = h('button', { type:'submit', style:{ background:'#0D6EFD', color:'#fff', border:'0', borderRadius:'8px', padding:'10px 14px', fontSize:'14px', cursor:'pointer' } , text:'Guardar nova palavra‑passe' });
				var show = h('button', { type:'button', style:{ background:'transparent', color:'#0D6EFD', border:'0', padding:'8px 10px', cursor:'pointer' }, text:'Mostrar/ocultar' });
				show.addEventListener('click', function(){ [cur.input, npw.input, cnp.input].forEach(function(i){ i.type = (i.type==='password'?'text':'password'); }); });
				actions.appendChild(btn); actions.appendChild(show);

				[info, nifRow, cur.wrap, npw.wrap, cnp.wrap, err, actions].forEach(function(node){ body.appendChild(node); });
				card.appendChild(header); card.appendChild(body); backdrop.appendChild(card); document.body.appendChild(backdrop);

				form.addEventListener('submit', function(e){ e.preventDefault(); }); // avoid default on Enter in fields
				btn.addEventListener('click', function(e){ e.preventDefault(); (async function(){
					var nif = userNif || '';
					var curVal = (cur.input.value||'').trim();
					var n1 = (npw.input.value||'').trim();
					var n2 = (cnp.input.value||'').trim();
					if (!curVal || !n1 || !n2) return err.textContent = 'Preencha todos os campos.';
					if (n1.length < 6) return err.textContent = 'A nova palavra‑passe deve ter pelo menos 6 caracteres.';
					if (n1 !== n2) return err.textContent = 'As palavras‑passe não coincidem.';
					try {
						btn.disabled = true; btn.textContent = 'A guardar…'; err.textContent = '';
						var resp = await fetch('/api/change-password', { method:'POST', headers:{ 'Content-Type':'application/json' }, body: JSON.stringify({ nif: String(nif||''), currentPassword: curVal, newPassword: n1 }) });
						var data = await resp.json().catch(function(){ return null; });
						if (!resp.ok){
							var msg = (data && (data.error||data.message)) || ('Erro ' + resp.status);
							throw new Error(msg);
						}
						try { sessionStorage.removeItem(MUST_KEY); } catch(e){}
						// Remove overlay and reload app to refresh user state
						backdrop.remove();
						// Optional: inform the user
						alert('Palavra‑passe alterada com sucesso.');
						location.reload();
					} catch(ex){
						err.textContent = ex && ex.message ? ex.message : 'Erro ao alterar a palavra‑passe.';
					} finally {
						btn.disabled = false; btn.textContent = 'Guardar nova palavra‑passe';
					}
				})(); });
			}

			function maybeShowFromFlag(){
				try {
					var nif = sessionStorage.getItem(MUST_KEY);
					if (nif) showOverlay(nif);
				} catch(e){}
			}

			// Intercept fetch to catch login responses
			(function(){
				if (!window.fetch) return;
				var origFetch = window.fetch.bind(window);
				window.fetch = function(input, init){
					var url = (typeof input === 'string') ? input : (input && input.url) || '';
					var method = (init && (init.method||init.type)) || 'GET';
					var p = origFetch(input, init);
					if (/\/api\/login(\b|$)/.test(url) && /post/i.test(method)){
						p.then(function(resp){
							try {
								var clone = resp.clone();
								clone.json().then(function(data){
									var u = data && data.user;
									if (u && (u.must_change_password === true || u.mustChangePassword === true)){
										var nif = u.NIF || u.nif || '';
										showOverlay(nif);
									}
								}).catch(function(){});
							} catch(e){}
						}).catch(function(){});
					}
					return p;
				};
			})();

			// Intercept XHR as a fallback (e.g., Axios)
			(function(){
				var XHR = window.XMLHttpRequest; if (!XHR) return;
				var open = XHR.prototype.open; var send = XHR.prototype.send;
				XHR.prototype.open = function(method, url){ this.__dg_url = url; this.__dg_method = method; return open.apply(this, arguments); };
				XHR.prototype.send = function(body){
					try {
						this.addEventListener('load', function(){
							try {
								var url = this.__dg_url || '';
								var method = this.__dg_method || 'GET';
								if (/\/api\/login(\b|$)/.test(url) && /post/i.test(method)){
									var data = {};
									try { data = JSON.parse(this.responseText||'{}'); } catch(e){}
									var u = data && data.user;
									if (u && (u.must_change_password === true || u.mustChangePassword === true)){
										var nif = u.NIF || u.nif || '';
										showOverlay(nif);
									}
								}
							} catch(e){}
						});
					} catch(e){}
					return send.apply(this, arguments);
				};
			})();

			// On load, if flag set, show overlay
			window.addEventListener('DOMContentLoaded', maybeShowFromFlag);
		})();

								/* Removed previous /equipa and /objetivos HTML injection to restore the original SPA behavior. */
	</script>
	<!-- Lightweight, non-intrusive enhancers for /equipa and /objetivos -->
	<script>
	(function(){
	  var STYLES_ID = 'dgx-static-styles';
	  var NODE_ID = 'dgx-static-container';

	  function ensureStyles(){
	    if (document.getElementById(STYLES_ID)) return;
	    var css = document.createElement('style');
	    css.id = STYLES_ID;
	    css.textContent = [
	      '.dgx-hidden{display:none !important}',
	      '#'+NODE_ID+'{isolation:isolate}',
	      '#'+NODE_ID+' .dgx-wrap{box-sizing:border-box;max-width:80rem;margin:0 auto;padding:32px 16px}',
		'#'+NODE_ID+' .dgx-title{font-weight:700;font-size:clamp(28px,4vw,36px);margin:0 0 10px;color:var(--accent)}',
		'#'+NODE_ID+' .dgx-sub{margin:0 0 24px;opacity:.8;color:var(--muted);font-weight:400}',
	      '#'+NODE_ID+' .dgx-back{margin:0 0 16px}',
		'#'+NODE_ID+' .dgx-back a{display:inline-flex;align-items:center;gap:6px;padding:0;background:none;border:0;line-height:1.2;color:var(--accent);font-weight:400;text-decoration:none;font-size:.875rem}',
		'#'+NODE_ID+' .dgx-back a:hover{color:var(--accent);text-decoration:none}',
	      '#'+NODE_ID+' .dgx-back a .arrow{font-size:1em;line-height:1}',
	      '#'+NODE_ID+' .dgx-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:18px}',
		'#'+NODE_ID+' .dgx-card{border:1px solid rgba(0,0,0,.08);border-radius:14px;padding:18px 16px;box-shadow:0 4px 10px rgba(0,0,0,.04);text-align:center;background:var(--dgx-bg, #fff)}',
		'#'+NODE_ID+' .dgx-card h3{margin:0 0 6px;font-size:16px;font-weight:500}',
		'#'+NODE_ID+' .dgx-card p{margin:0;font-size:13px;opacity:.9;font-weight:400}',
		'#'+NODE_ID+' .dgx-obj{border:1px solid rgba(0,0,0,.08);border-radius:16px;padding:24px 22px;box-shadow:0 6px 16px rgba(0,0,0,.06);background:var(--dgx-bg, #fff)}',
		'#'+NODE_ID+' .dgx-obj p{font-weight:400}',
	      '@media (min-width:640px){#'+NODE_ID+' .dgx-wrap{padding-left:24px;padding-right:24px}}',
	      '@media (min-width:1024px){#'+NODE_ID+' .dgx-wrap{padding-left:32px;padding-right:32px}}'
	    ].join('\n');
	    document.head.appendChild(css);
	  }

	  function mainEl(){
	    return document.querySelector('main') || document.querySelector('[role="main"]') || document.querySelector('#root');
	  }

	  function hideSiblingsExcept(host, keep){
	    if (!host) return;
	    var kids = Array.prototype.slice.call(host.children || []);
	    kids.forEach(function(ch){ if (ch !== keep) ch.classList.add('dgx-hidden'); });
	  }
	  function showAll(host){
	    if (!host) return;
	    var kids = Array.prototype.slice.call(host.children || []);
	    kids.forEach(function(ch){ ch.classList.remove('dgx-hidden'); });
	  }

	  function buildEquipa(){
	    var html = ''+
	      '<div class="dgx-wrap">'+
	        '<div class="dgx-back"><a href="/"><span class="arrow">←</span> Voltar ao Início</a></div>'+
	        '<h1 class="dgx-title">A Nossa Equipa</h1>'+
	        '<p class="dgx-sub">Profissionais dedicados à gestão e valorização do seu condomínio.</p>'+
	        '<div class="dgx-grid">'+
	          card('Paulo Peixoto','Administrador de Condomínios')+
	          card('Rosário Oliveira','Administradora de Condomínios')+
	          card('Manuela Gonçalves','Administradora de Condomínios')+
	          card('Paula Santos','Front Office')+
	          card('Catarina Mourão','Gestão de Cobranças')+
	          card('Liliana Silva','Assessoria à Administração e Pagamentos a Fornecedores')+
	          card('Jéssica Silva','Gestão das Áreas Contabilísticas')+
	        '</div>'+
	      '</div>';
	    return html;
	  }

	  function buildObjetivos(){
	    var texto = 'Somos uma empresa de Administração de Condomínios, com escritório em Espinho. A nossa área de atuação desenvolve-se, essencialmente, para além de Espinho, em que temos a administração de cerca de oitenta prédios, estamos também nos concelhos de Gaia, Ovar e Santa Maria da Feira, em freguesias como: Pedroso, Avintes, Grijó, Seixezelo, Valadares, Madalena, Gulpilhares, Vilar do Paraíso, Arcozelo, S. Félix da Marinha, Esmoriz, Cortegaça, Oleiros, Mozelos, Nogueira da Regedoura e Santa Maria da Feira.';
	    var html = ''+
	      '<div class="dgx-wrap">'+
	        '<div class="dgx-back"><a href="/"><span class="arrow">←</span> Voltar ao Início</a></div>'+
	        '<h1 class="dgx-title">Objetivos</h1>'+
	        '<div class="dgx-obj"><p>'+texto+'</p></div>'+
	      '</div>';
	    return html;
	  }

	  function card(nome, cargo){
	    return '<div class="dgx-card"><h3>'+nome+'</h3><p>'+cargo+'</p></div>';
	  }

	  var active = { mounted:false, host:null, node:null };
      var observer = null;

	  function mount(contentHtml){
	    ensureStyles();
	    var host = mainEl(); if (!host) return;
	    cleanup();
			var node = document.createElement('section');
	    node.id = NODE_ID;
	    node.innerHTML = contentHtml;
	    // Insert as first child to keep site header above and footer below
	    if (host.firstChild) host.insertBefore(node, host.firstChild); else host.appendChild(node);
	    hideSiblingsExcept(host, node);
			active = { mounted:true, host:host, node:node };
			// Hook back link for SPA-style navigation
			try {
			  var back = node.querySelector('.dgx-back a');
			  if (back) back.addEventListener('click', function(e){
			    e.preventDefault();
			    try { history.pushState({}, '', '/'); } catch(_) { location.href = '/'; return; }
			    sync();
			  });
			} catch(e){}
			// Keep re-hiding if React re-renders siblings
			try {
				if (observer) { observer.disconnect(); observer = null; }
				if (window.MutationObserver) {
					observer = new MutationObserver(function(){
						if (active.mounted && active.host && active.node) hideSiblingsExcept(active.host, active.node);
					});
					observer.observe(host, { childList:true });
				}
			} catch(e){}
	  }

	  function cleanup(){
	    if (!active.mounted) return;
	    try { if (active.node && active.node.parentNode) active.node.parentNode.removeChild(active.node); } catch(e){}
	    showAll(active.host);
	    active = { mounted:false, host:null, node:null };
		if (observer) { try { observer.disconnect(); } catch(e){} observer = null; }
	  }

	  function sync(){
	    var p = (window.location.pathname||'').replace(/\/+$/,'');
	    if (p === '/equipa') return mount(buildEquipa());
	    if (p === '/objetivos') return mount(buildObjetivos());
	    cleanup();
	  }

	  // Hook navigation without altering history behavior
	  window.addEventListener('DOMContentLoaded', function(){ setTimeout(sync, 0); });
	  window.addEventListener('load', function(){ setTimeout(sync, 0); });
	  (function(){
	    var push = history.pushState, replace = history.replaceState;
	    if (push) history.pushState = function(){ var r = push.apply(this, arguments); try{ sync(); }catch(e){} return r; };
	    if (replace) history.replaceState = function(){ var r = replace.apply(this, arguments); try{ sync(); }catch(e){} return r; };
	    window.addEventListener('popstate', function(){ try{ sync(); }catch(e){} });
	  })();
	})();
	</script>
	<script defer="defer" src="/static/js/main.cb9b9f7a.js"></script><link href="/static/css/main.ff967427.css" rel="stylesheet"></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"></div></body></html>